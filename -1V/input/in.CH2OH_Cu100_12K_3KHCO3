#TEST
units           real
atom_style      full
boundary        p p f
dielectric      1
special_bonds   lj/coul 0.0 0.0 0.5 

pair_style      hybrid/overlay lj/charmm/coul/long/opt 12 13 buck/coul/long 13 hbond/dreiding/morse 2 5.0 6.0 90.0 
bond_style      harmonic  
angle_style     harmonic  
dihedral_style  charmm
improper_style  umbrella
kspace_style    pppm 1.0E-04
kspace_modify   slab 3.0
processors      * * 1

read_restart CH2OH_Cu100_3KHCO3.step1.emd.1000000.restart
   
pair_coeff	1	1	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	2	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	3	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	4	buck/coul/long	4295.161 	0.395 	1234.429 
pair_coeff	1	5	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	6	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	7	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	8	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	9	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	10	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	11	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	12	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	1	13	lj/charmm/coul/long/opt	0.000 	0.000 	
						
pair_coeff	2	2	lj/charmm/coul/long/opt	0.102 	3.188 	
pair_coeff	2	3	lj/charmm/coul/long/opt	0.244 	2.928 	
pair_coeff	2	4	buck/coul/long	23354.500 	0.288 	701.090 
pair_coeff	2	5	lj/charmm/coul/long/opt	0.103 	3.458 	
pair_coeff	2	6	lj/charmm/coul/long/opt	0.132 	3.093 	
pair_coeff	2	7	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	2	8	lj/charmm/coul/long/opt	0.055 	2.823 	
pair_coeff	2	9	lj/charmm/coul/long/opt	0.103 	3.458 	
pair_coeff	2	10	lj/charmm/coul/long/opt	0.146 	3.072 	
pair_coeff	2	11	lj/charmm/coul/long/opt	0.146 	3.072 	
pair_coeff	2	12	lj/charmm/coul/long/opt	0.132 	3.093 	
pair_coeff	2	13	lj/charmm/coul/long/opt	0.055 	1.263 	
						
pair_coeff	3	3	lj/charmm/coul/long/opt	0.583 	2.690 	
pair_coeff	3	4	buck/coul/long	697172.000 	0.271 	744.000 
pair_coeff	3	5	lj/charmm/coul/long/opt	0.247 	3.176 	
pair_coeff	3	6	lj/charmm/coul/long/opt	0.315 	2.841 	
pair_coeff	3	7	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	3	8	lj/charmm/coul/long/opt	0.132 	2.593 	
pair_coeff	3	9	lj/charmm/coul/long/opt	0.247 	3.176 	
pair_coeff	3	10	lj/charmm/coul/long/opt	0.350 	2.822 	
pair_coeff	3	11	lj/charmm/coul/long/opt	0.350 	2.822 	
pair_coeff	3	12	lj/charmm/coul/long/opt	0.315 	2.841 	
pair_coeff	3	13	lj/charmm/coul/long/opt	0.132 	1.160 	
						
pair_coeff	4	4	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	4	5	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	4	6	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	4	7	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	4	8	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	4	9	buck/coul/long	522751.000 	0.267 	3688.000 
pair_coeff	4	10	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	4	11	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	4	12	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	4	13	lj/charmm/coul/long/opt	0.000 	0.000 	
						
pair_coeff	5	5	lj/charmm/coul/long/opt	0.105 	3.750 	
pair_coeff	5	6	lj/charmm/coul/long/opt	0.134 	3.354 	
pair_coeff	5	7	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	5	8	lj/charmm/coul/long/opt	0.056 	3.062 	
pair_coeff	5	9	lj/charmm/coul/long/opt	0.105 	3.750 	
pair_coeff	5	10	lj/charmm/coul/long/opt	0.148 	3.332 	
pair_coeff	5	11	lj/charmm/coul/long/opt	0.148 	3.332 	
pair_coeff	5	12	lj/charmm/coul/long/opt	0.134 	3.354 	
pair_coeff	5	13	lj/charmm/coul/long/opt	0.056 	1.369 	
						
pair_coeff	6	6	lj/charmm/coul/long/opt	0.170 	3.000 	
pair_coeff	6	7	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	6	8	lj/charmm/coul/long/opt	0.071 	2.739 	
pair_coeff	6	9	lj/charmm/coul/long/opt	0.134 	3.354 	
pair_coeff	6	10	lj/charmm/coul/long/opt	0.189 	2.980 	
pair_coeff	6	11	lj/charmm/coul/long/opt	0.189 	2.980 	
pair_coeff	6	12	lj/charmm/coul/long/opt	0.170 	3.000 	
pair_coeff	6	13	lj/charmm/coul/long/opt	0.071 	1.225 	
						
pair_coeff	7	7	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	7	8	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	7	9	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	7	10	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	7	11	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	7	12	lj/charmm/coul/long/opt	0.000 	0.000 	
pair_coeff	7	13	lj/charmm/coul/long/opt	0.000 	0.000 	
						
pair_coeff	8	8	lj/charmm/coul/long/opt	0.030 	2.500 	
pair_coeff	8	9	lj/charmm/coul/long/opt	0.056 	3.062 	
pair_coeff	8	10	lj/charmm/coul/long/opt	0.079 	2.720 	
pair_coeff	8	11	lj/charmm/coul/long/opt	0.079 	2.720 	
pair_coeff	8	12	lj/charmm/coul/long/opt	0.071 	2.739 	
pair_coeff	8	13	lj/charmm/coul/long/opt	0.030 	1.118 	
						
pair_coeff	9	9	lj/charmm/coul/long/opt	0.105 	3.750 	
pair_coeff	9	10	lj/charmm/coul/long/opt	0.148 	3.332 	
pair_coeff	9	11	lj/charmm/coul/long/opt	0.148 	3.332 	
pair_coeff	9	12	lj/charmm/coul/long/opt	0.134 	3.354 	
pair_coeff	9	13	lj/charmm/coul/long/opt	0.056 	1.369 	
						
pair_coeff	10	10	lj/charmm/coul/long/opt	0.210 	2.960 	
pair_coeff	10	11	lj/charmm/coul/long/opt	0.210 	2.960 	
pair_coeff	10	12	lj/charmm/coul/long/opt	0.189 	2.980 	
pair_coeff	10	13	lj/charmm/coul/long/opt	0.079 	1.217 	
						
pair_coeff	11	11	lj/charmm/coul/long/opt	0.210 	2.960 	
pair_coeff	11	12	lj/charmm/coul/long/opt	0.189 	2.980 	
pair_coeff	11	13	lj/charmm/coul/long/opt	0.079 	1.217 	
						
pair_coeff	12	12	lj/charmm/coul/long/opt	0.170 	3.000 	
pair_coeff	12	13	lj/charmm/coul/long/opt	0.071 	1.225 	
						
pair_coeff	13	13	lj/charmm/coul/long/opt	0.030 	0.500 	

pair_coeff 2 6  hbond/dreiding/morse 1 i 0.119 1.258 4.116 # qm as acceptor  
pair_coeff 2 6  hbond/dreiding/morse 7 j 0.062 1.198 4.352 # qm as donor

pair_coeff 6 10 hbond/dreiding/morse 7 i 0.062 1.198 4.352 # qm as donor
pair_coeff 6 11 hbond/dreiding/morse 7 i 0.062 1.198 4.352 # qm as donor
pair_coeff 6 12 hbond/dreiding/morse 7 i 0.062 1.198 4.352 # qm as donor

pair_coeff 6 12 hbond/dreiding/morse 13 j 0.119 1.258 4.116 # qm as acceptor

variable        sname index CH2OH_Cu100_3KHCO3        

pair_modify     table 0
neighbor        2.0 multi
neigh_modify    every 2 delay 4 check yes
thermo_style    multi

group           SOLUTE type 4 5 6 7 8 
group           ION type 3
group           SOLVENT type 1 2
group           HCO3 type 9 10 11 12 13
group           MOBILE subtract all SOLUTE

neigh_modify    exclude group SOLUTE SOLUTE

compute         tempMobile MOBILE temp
compute         pressMobile all pressure tempMobile
compute         pairUS SOLUTE group/group SOLVENT pair yes
compute         pairUI SOLUTE group/group ION pair yes
compute         pairSI SOLVENT group/group ION pair yes
compute         pairSS SOLVENT group/group SOLVENT pair yes
compute         pairII ION group/group ION pair yes

compute         pppmUS SOLUTE group/group SOLVENT pair no kspace yes
compute         pppmUI SOLUTE group/group ION pair no kspace yes
compute         pppmSI SOLVENT group/group ION pair no kspace yes
compute         pppmSS SOLVENT group/group SOLVENT pair no kspace yes
compute         pppmII ION group/group ION pair no kspace yes

fix             solvGrid SOLVENT gridforce -1 9 0	# for SOLVENT group, scale -1, no-supercell,ID
fix             catGrid ION gridforce -1 9 1		# for ION group, scale -1, no-supercell,ID
fix             aniGrid HCO3 gridforce -1 9 2		# for ION group, scale -1, no-supercell,ID
fix_modify      solvGrid energy yes			# include grid energy to lammps total energy
fix_modify      catGrid energy yes			# include grid energy to lammps total energy
fix_modify      aniGrid energy yes			# include grid energy to lammps total energy
grid            ./solute.cube yes 3 SOLVENT.cube cat.cube ani.cube

timestep        1.0
thermo          100
thermo_style    custom etotal temp c_tempMobile ke pe ebond eangle evdwl ecoul elong press c_pressMobile c_pairUS c_pairUI c_pairSI c_pairSS c_pairII c_pppmUS c_pppmUI c_pppmSI c_pppmSS c_pppmII f_solvGrid f_catGrid f_aniGrid 
thermo_modify   line multi format float %10.5f

fix             1 MOBILE momentum 1 linear 1 1 1 angular
fix             shakeH all shake 0.0001 20 500 b 1 a 3
fix             wallhi MOBILE wall/harmonic zhi 40.0 1.0 1.0 2.0
fix             wallci SOLVENT wall/reflect zlo 5.57  
fix             wallai HCO3 wall/reflect zlo 6.10   #HCO3-wall

reset_timestep  0
dump            1 all custom 1000 ${sname}.step2.emd.lammpstrj id type xu yu zu
dump_modify     1 sort id
restart         500000 ${sname}.step2.emd.*.restart
fix             3 MOBILE nvt temp 300.0 300.0 100.0
run		1000000
